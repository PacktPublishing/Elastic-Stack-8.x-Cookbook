# Semantic search by using the text_expansion query
POST movies-sparse-vector/_search
{
   "query":{
      "text_expansion":{
         "plot_sparse_vector":{
            "model_id":".elser_model_2",
            "model_text":" romantic moment"
         }
      }
   }
}

# Using Elser in search application template
PUT _application/search_application/movie_vector_search_application
{
  "indices": [
    "movies-sparse-vector"
  ],
  "template": {
    "script": {
      "lang": "mustache",
      "source": """
      {
          "query":{
                "text_expansion":{
                   "plot_sparse_vector":{
                      "model_id":"{{elser_model_id}}",
                      "model_text": "{{query}}"
                   }
                }
             },
          "fields": {{#toJson}}fields{{/toJson}},
          "aggs": {
            "genre_facet": {
              "terms": {
                "field": "genre",
                "size": "{{agg_size}}"
              }
            },
            "director_facet": {
              "terms": {
                "field": "director.keyword",
                "size": "{{agg_size}}"
              }
            }
          },
      }
      """,
      "params": {
        "elser_model_id": ".elser_model_2_linux-x86_64",
        "query": "",
        "_es_filters": [],
        "fields": ["title", "plot"],
        "agg_size": 5
      }
    }
  }
}

# hybrid search with text_expansion query